# -*- makefile -*-
# -----------------------------------------------------------------------
# Intent: Skeleton template makefile with common targets
# -----------------------------------------------------------------------

.PHONY: help
.DEFAULT_GOAL := help

HIDE ?= @

xargs-n1 := xargs -I'{}' --null --no-run-if-empty

# -----------------------------------------------------------------------
# -----------------------------------------------------------------------
all :

# -----------------------------------------------------------------------
# -----------------------------------------------------------------------
lint ::
	make --dry-run -f makefile

# -----------------------------------------------------------------------
# -----------------------------------------------------------------------
test ::
	./unit.sh

# -----------------------------------------------------------------------
# -----------------------------------------------------------------------
clean ::

# -----------------------------------------------------------------------
# -----------------------------------------------------------------------
sterile ::

        # Remove editor temp files
	$(HIDE)find . \( -name '*~' -o -name '#*#' -o -name '\.#*' \) -print0 \
  | $(xargs-n1) $(RM)

        # Remove cached and compiled python files
	$(HIDE)find . \( '-name' '__pycache__' \) -print0 \
  | $(xargs-n1) $(RM) -r {}

# -----------------------------------------------------------------------
# -----------------------------------------------------------------------
help ::
	@echo 'Usage: $(MAKE) [options] [target] ...'
	@echo 'Options:'
	@echo 'Targets:'
	@echo '  help                   Display supported targets and usage'
	@echo '  lint                   Syntax check sources'
	@echo
	@echo '[CLEAN]'
	@echo '  clean                  Remove generated targets'
	@echo '  sterile                Revert sandbox to a pristine state'

# [EOF]
